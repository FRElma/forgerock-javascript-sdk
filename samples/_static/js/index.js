!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("forgerock",[],t):"object"==typeof exports?exports.forgerock=t():e.forgerock=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=42)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.payload=e}return e.prototype.getType=function(){return this.payload.type},e.prototype.getInputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.input,e).value},e.prototype.setInputValue=function(e,t){void 0===t&&(t=0),this.getArrayElement(this.payload.input,t).value=e},e.prototype.getOutputValue=function(e){return void 0===e&&(e=0),this.getArrayElement(this.payload.output,e).value},e.prototype.getOutputByName=function(e,t){var n=this.payload.output.find((function(t){return t.name===e}));return n?n.value:t},e.prototype.getArrayElement=function(e,t){if(void 0===t&&(t=0),void 0===e)throw new Error("No NameValue array was provided to search (selector "+t+")");if("number"==typeof t){if(t<0||t>e.length-1)throw new Error("Selector index "+t+" is out of range");return e[t]}if("string"==typeof t){var n=e.find((function(e){return e.name===t}));if(!n)throw new Error('Missing callback input entry "'+t+'"');return n}throw new Error("Invalid selector value type")},e}();t.default=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TIMEOUT=void 0;var o=n(43);Object.defineProperty(t,"DEFAULT_TIMEOUT",{enumerable:!0,get:function(){return o.DEFAULT_TIMEOUT}});var i=function(){function e(){}return e.set=function(e){if(!this.isValid(e))throw new Error("Configuration is invalid");e.serverConfig&&this.validateServerConfig(e.serverConfig),this.options=r({},e)},e.get=function(e){if(!this.options&&!e)throw new Error("Configuration has not been set");var t=r(r({},this.options),e);if(!t.serverConfig||!t.serverConfig.baseUrl)throw new Error("Server configuration has not been set");return t},e.isValid=function(e){return!(!e||!e.serverConfig)},e.validateServerConfig=function(e){e.timeout||(e.timeout=o.DEFAULT_TIMEOUT);var t=e.baseUrl;t&&"/"!==t.charAt(t.length-1)&&(e.baseUrl=t+"/")},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0}),t.stringify=t.resolve=t.parseQuery=t.getEndpointPath=t.getBaseUrl=void 0;var o=n(44);function i(e){var t="http:"===e.protocol&&-1===["","80"].indexOf(e.port)||"https:"===e.protocol&&-1===["","443"].indexOf(e.port)?":"+e.port:"";return e.protocol+"//"+e.hostname+t}t.getBaseUrl=i,t.getEndpointPath=function(e,t,n){var r=o.getRealmUrlPath(t),i={authenticate:"json/"+r+"/authenticate",authorize:"oauth2/"+r+"/authorize",accessToken:"oauth2/"+r+"/access_token",endSession:"oauth2/"+r+"/connect/endSession",userInfo:"oauth2/"+r+"/userinfo",revoke:"oauth2/"+r+"/token/revoke",sessions:"json/"+r+"/sessions/"};return n&&n[e]?n[e]:i[e]},t.resolve=function(e,t){var n=new URL(e);if(t.startsWith("/"))return""+i(n)+t;var o=n.pathname.split("/"),a=t.split("/").filter((function(e){return!!e})),u=r(o.slice(0,-1),a).join("/");return""+i(n)+u},t.parseQuery=function(e){var t=new URL(e),n={};return t.searchParams.forEach((function(e,t){return n[t]=e})),n},t.stringify=function(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.StepType=void 0,function(e){e.LoginFailure="LoginFailure",e.LoginSuccess="LoginSuccess",e.Step="Step"}(r||(r={})),t.StepType=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActionTypes=void 0,function(e){e.Authenticate="AUTHENTICATE",e.Authorize="AUTHORIZE",e.Logout="LOGOUT",e.ExchangeToken="EXCHANGE_TOKEN",e.RefreshToken="REFRESH_TOKEN",e.RevokeToken="REVOKE_TOKEN",e.StartAuthenticate="START_AUTHENTICATE",e.UserInfo="USER_INFO"}(t.ActionTypes||(t.ActionTypes={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.withTimeout=void 0;var r=n(1);t.withTimeout=function(e,t){void 0===t&&(t=r.DEFAULT_TIMEOUT);var n=t||r.DEFAULT_TIMEOUT;return Promise.race([e,new Promise((function(e,t){return window.setTimeout((function(){return t(new Error("Timeout"))}),n)}))])}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(1));t.default=function(e,t,n){var r=o.default.get().middleware;if(!Array.isArray(r))return e;var i=Object.freeze({type:t,payload:n}),a=r.map((function(e){return e}));return function t(){var n=a.shift();return n&&n(e,i,t),e}()}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseType=void 0;var a=n(4),u=i(n(1)),c=i(n(8)),s=n(38),l=i(n(12)),f=n(5),d=n(2),p=n(56);Object.defineProperty(t,"ResponseType",{enumerable:!0,get:function(){return p.ResponseType}});var h=i(n(6)),y=function(){function e(){}return e.getAuthorizeUrl=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,c,s,f,d,p=this;return o(this,(function(o){switch(o.label){case 0:return t=u.default.get(e),n=t.serverConfig,r=t.clientId,i=t.redirectUri,c=t.scope,s={client_id:r,redirect_uri:i,response_type:e.responseType,scope:c,state:e.state},e.verifier?[4,l.default.createChallenge(e.verifier)]:[3,2];case 1:f=o.sent(),s.code_challenge=f,s.code_challenge_method="S256",o.label=2;case 2:return d=h.default({url:new URL(this.getUrl("authorize",s,e)),init:{}},a.ActionTypes.Authorize).url,[2,new Promise((function(e,t){var r,o=document.createElement("iframe"),i=function(){},a=i,u=0;r=function(){window.clearTimeout(u),o.removeEventListener("load",a),o.remove()},a=function(){if(o.contentWindow){var t=o.contentWindow.location.href;p.containsAuthCode(t)&&(r(),e(t))}},u=window.setTimeout((function(){r(),t("Timeout")}),n.timeout),o.style.display="none",o.addEventListener("load",a),document.body.appendChild(o),o.src=d.toString()}))]}}))}))},e.getOAuth2Tokens=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a,c,s,l,f,p;return o(this,(function(o){switch(o.label){case 0:return t=u.default.get(e),n=t.clientId,r=t.redirectUri,i={client_id:n,code:e.authorizationCode,grant_type:"authorization_code",redirect_uri:r},e.verifier&&(i.code_verifier=e.verifier),a=d.stringify(i),c={body:a,headers:{"content-length":a.length.toString(),"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("accessToken",void 0,!1,c,e)];case 1:return s=o.sent(),[4,this.getBody(s)];case 2:if(l=o.sent(),200!==s.status)throw f="string"==typeof l?"Expected 200, received "+s.status:this.parseError(l),new Error(f);if(!(p=l).access_token)throw new Error("Access token not found in response");return[2,{accessToken:p.access_token,idToken:p.id_token,refreshToken:p.refresh_token}]}}))}))},e.getUserInfo=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.request("userInfo",void 0,!0,void 0,e)];case 1:if(200!==(t=n.sent()).status)throw new Error("Failed to get user info; received "+t.status);return[4,t.json()];case 2:return[2,n.sent()]}}))}))},e.endSession=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return[4,c.default.get()];case 1:return t=o.sent().idToken,n={},t&&(n.id_token_hint=t),[4,this.request("endSession",n,!0,void 0,e)];case 2:if(r=o.sent(),!s.isOkOr4xx(r))throw new Error("Failed to end session; received "+r.status);return[2,r]}}))}))},e.revokeToken=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i;return o(this,(function(o){switch(o.label){case 0:return t=u.default.get(e).clientId,[4,c.default.get()];case 1:return n=o.sent().accessToken,r={body:d.stringify({client_id:t,token:n}),credentials:"include",headers:{"content-type":"application/x-www-form-urlencoded"},method:"POST"},[4,this.request("revoke",void 0,!1,r,e)];case 2:if(i=o.sent(),!s.isOkOr4xx(i))throw new Error("Failed to revoke token; received "+i.status);return[2,i]}}))}))},e.request=function(e,t,n,i,s){return r(this,void 0,void 0,(function(){var r,l,d,p,y;return o(this,(function(o){switch(o.label){case 0:return r=u.default.get(s).serverConfig,l=this.getUrl(e,t,s),d=function(e){switch(e){case"accessToken":return a.ActionTypes.ExchangeToken;case"endSession":return a.ActionTypes.Logout;case"revoke":return a.ActionTypes.RevokeToken;default:return a.ActionTypes.UserInfo}},i=i||{},n?[4,c.default.get()]:[3,2];case 1:p=o.sent().accessToken,i.credentials="include",i.headers=i.headers||new Headers,i.headers.set("authorization","Bearer "+p),o.label=2;case 2:return y=h.default({url:new URL(l),init:i},d(e)),[4,f.withTimeout(fetch(y.url.toString(),y.init),r.timeout)];case 3:return[2,o.sent()]}}))}))},e.containsAuthCode=function(e){return!!e&&/code=([^&]+)/.test(e)},e.getBody=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return(t=e.headers.get("content-type"))&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return[2,n.sent()];case 2:return[4,e.text()];case 3:return[2,n.sent()]}}))}))},e.parseError=function(e){if(e){if(e.error&&e.error_description)return e.error+": "+e.error_description;if(e.code&&e.message)return e.code+": "+e.message}},e.getUrl=function(e,t,n){var r=u.default.get(n),o=r.realmPath,i=r.serverConfig,a=d.getEndpointPath(e,o,i.paths),c=d.resolve(i.baseUrl,a);return t&&(c+="?"+d.stringify(t)),c},e}();t.default=y},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(1)),u=i(n(53)),c=i(n(54)),s=i(n(55)),l=function(){function e(){}return e.get=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return e=this.getClientConfig(),t=e.clientId,"sessionStorage"!==(n=e.tokenStore)?[3,2]:[4,s.default.get(t)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,c.default.get(t)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,u.default.get(t)];case 5:return[2,r.sent()];case 6:return n&&n.get?[4,n.get(t)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,u.default.get(t)];case 9:return[2,r.sent()]}}))}))},e.set=function(e){return r(this,void 0,void 0,(function(){var t,n,r;return o(this,(function(o){switch(o.label){case 0:return t=this.getClientConfig(),n=t.clientId,"sessionStorage"!==(r=t.tokenStore)?[3,2]:[4,s.default.set(n,e)];case 1:return[2,o.sent()];case 2:return"localStorage"!==r?[3,4]:[4,c.default.set(n,e)];case 3:return[2,o.sent()];case 4:return"indexedDB"!==r?[3,6]:[4,u.default.set(n,e)];case 5:return[2,o.sent()];case 6:return r&&r.set?[4,r.set(n,e)]:[3,8];case 7:return[2,o.sent()];case 8:return[4,u.default.set(n,e)];case 9:return[2,o.sent()]}}))}))},e.remove=function(){return r(this,void 0,void 0,(function(){var e,t,n;return o(this,(function(r){switch(r.label){case 0:return e=this.getClientConfig(),t=e.clientId,"sessionStorage"!==(n=e.tokenStore)?[3,2]:[4,s.default.remove(t)];case 1:return[2,r.sent()];case 2:return"localStorage"!==n?[3,4]:[4,c.default.remove(t)];case 3:return[2,r.sent()];case 4:return"indexedDB"!==n?[3,6]:[4,u.default.remove(t)];case 5:return[2,r.sent()];case 6:return n&&n.remove?[4,n.remove(t)]:[3,8];case 7:return[2,r.sent()];case 8:return[4,u.default.remove(t)];case 9:return[2,r.sent()]}}))}))},e.getClientConfig=function(){var e=a.default.get(),t=e.clientId,n=e.tokenStore;if(!t)throw new Error("clientId is required to manage token storage");return{clientId:t,tokenStore:n}},e}();t.default=l},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorCode=t.CallbackType=void 0,function(e){e.BadRequest="BAD_REQUEST",e.Timeout="TIMEOUT",e.Unauthorized="UNAUTHORIZED",e.Unknown="UNKNOWN"}(r||(r={})),t.ErrorCode=r,function(e){e.BooleanAttributeInputCallback="BooleanAttributeInputCallback",e.ChoiceCallback="ChoiceCallback",e.ConfirmationCallback="ConfirmationCallback",e.DeviceProfileCallback="DeviceProfileCallback",e.HiddenValueCallback="HiddenValueCallback",e.KbaCreateCallback="KbaCreateCallback",e.MetadataCallback="MetadataCallback",e.NameCallback="NameCallback",e.PasswordCallback="PasswordCallback",e.PollingWaitCallback="PollingWaitCallback",e.ReCaptchaCallback="ReCaptchaCallback",e.StringAttributeInputCallback="StringAttributeInputCallback",e.TermsAndConditionsCallback="TermsAndConditionsCallback",e.TextOutputCallback="TextOutputCallback",e.ValidatedCreatePasswordCallback="ValidatedCreatePasswordCallback",e.ValidatedCreateUsernameCallback="ValidatedCreateUsernameCallback"}(o||(o={})),t.CallbackType=o},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(48)),i=n(3),a=function(){function e(e,t){this.payload=e,this.type=i.StepType.Step,this.callbacks=[],e.callbacks&&(this.callbacks=this.convertCallbacks(e.callbacks,t))}return e.prototype.getCallbackOfType=function(e){var t=this.getCallbacksOfType(e);if(1!==t.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+t.length);return t[0]},e.prototype.getCallbacksOfType=function(e){return this.callbacks.filter((function(t){return t.getType()===e}))},e.prototype.setCallbackValue=function(e,t){var n=this.getCallbacksOfType(e);if(1!==n.length)throw new Error('Expected 1 callback of type "'+e+'", but found '+n.length);n[0].setInputValue(t)},e.prototype.getDescription=function(){return this.payload.description},e.prototype.getHeader=function(){return this.payload.header},e.prototype.getStage=function(){return this.payload.stage},e.prototype.convertCallbacks=function(e,t){return e.map((function(e){return(t||o.default)(e)||o.default(e)}))},e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TOKEN_KEY=t.DB_NAME=void 0;t.DB_NAME="forgerock-sdk";t.TOKEN_KEY="tokens"},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}return e.createVerifier=function(e){void 0===e&&(e=32);var t=new Uint8Array(e);return window.crypto.getRandomValues(t),this.base64UrlEncode(t)},e.createChallenge=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,this.sha256(e)];case 1:return t=n.sent(),[2,this.base64UrlEncode(t)]}}))}))},e.base64UrlEncode=function(e){var t=Array.prototype.slice.call(e);return window.btoa(String.fromCharCode.apply(null,t)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},e.sha256=function(e){return r(this,void 0,void 0,(function(){var t,n;return o(this,(function(r){switch(r.label){case 0:return t=(new TextEncoder).encode(e),[4,window.crypto.subtle.digest("SHA-256",t)];case 1:return n=r.sent(),[2,new Uint8Array(n)]}}))}))},e}();t.default=i},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&o(t,e,n);return i(t,e),t},u=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(7)),f=s(n(8)),d=s(n(39)),p=s(n(12)),h=n(2),y=function(){function e(){}return e.getTokens=function(e){return u(this,void 0,void 0,(function(){var t,n,o,i,a,u,s,y,v,b;return c(this,(function(c){switch(c.label){case 0:if(e&&e.forceRenew)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,f.default.get()];case 2:return(t=c.sent())?[2,t]:[3,4];case 3:return n=c.sent(),console.error("Failed to retrieve stored tokens",n),[3,4];case 4:return o=p.default.createVerifier(),i=d.default()().toString(),a=r(r({},e),{responseType:l.ResponseType.Code,state:i,verifier:o}),[4,l.default.getAuthorizeUrl(a)];case 5:if(u=c.sent(),(s=h.parseQuery(u)).state!==i)throw new Error("State mismatch");if(!s.code||Array.isArray(s.code))throw new Error("Failed to acquire authorization code");return y=s.code,v=r(r({},e),{authorizationCode:y,verifier:o}),[4,l.default.getOAuth2Tokens(v)];case 6:t=c.sent(),c.label=7;case 7:return c.trys.push([7,9,,10]),[4,f.default.set(t)];case 8:return c.sent(),[3,10];case 9:return b=c.sent(),console.error("Failed to store tokens",b),[3,10];case 10:return[2,t]}}))}))},e.deleteTokens=function(){return u(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,f.default.remove()];case 1:return e.sent(),[2]}}))}))},e}();t.default=y},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=a(n(1)),c=n(4),s=n(15),l=n(5),f=n(2),d=a(n(6)),p=function(){function e(){}return e.next=function(e,t){return o(this,void 0,void 0,(function(){var n,r,o,a,s,f,p,h,y;return i(this,(function(i){switch(i.label){case 0:return n=u.default.get(t),r=n.realmPath,o=n.serverConfig,a=n.tree,s=n.type,f=t?t.query:{},p=this.constructUrl(o,r,a,f),h=d.default({url:new URL(p),init:this.configureRequest(e)},e?c.ActionTypes.Authenticate:c.ActionTypes.StartAuthenticate,{tree:a,type:s||"service"}),[4,l.withTimeout(fetch(h.url.toString(),h.init),o.timeout)];case 1:return y=i.sent(),[4,this.getResponseJson(y)];case 2:return[2,i.sent()]}}))}))},e.constructUrl=function(e,t,n,o){var i=n?{authIndexType:"service",authIndexValue:n}:void 0,a=r(r({},o),i),u=Object.keys(a).length>0?"?"+f.stringify(a):"",c=f.getEndpointPath("authenticate",t,e.paths);return f.resolve(e.baseUrl,""+c+u)},e.configureRequest=function(e){return{body:e?JSON.stringify(e):void 0,credentials:"include",headers:{accept:"application/json","accept-api-version":"protocol=1.0,resource=2.1","content-type":"application/json","x-requested-with":s.REQUESTED_WITH},method:"POST"}},e.getResponseJson=function(e){return o(this,void 0,void 0,(function(){var t,n,r;return i(this,(function(o){switch(o.label){case 0:return t=e.headers.get("content-type"),t&&t.indexOf("application/json")>-1?[4,e.json()]:[3,2];case 1:return r=o.sent(),[3,3];case 2:r={},o.label=3;case 3:return(n=r).status=e.status,n.ok=e.ok,[2,n]}}))}))},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.REQUESTED_WITH=void 0;t.REQUESTED_WITH="forgerock-sdk"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(45),o=function(){function e(){this.callbacks={}}return e.prototype.addEventListener=function(e,t){r.add(this.callbacks,e,t)},e.prototype.removeEventListener=function(e,t){r.remove(this.callbacks,e,t)},e.prototype.clearEventListeners=function(e){r.clear(this.callbacks,e)},e.prototype.dispatchEvent=function(e){if(this.callbacks[e.type])for(var t=0,n=this.callbacks[e.type];t<n.length;t++){(0,n[t])(e)}},e}();t.default=o},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(14)),u=i(n(18)),c=i(n(22)),s=i(n(10)),l=function(){function e(){}return e.next=function(e,t){return r(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,a.default.next(e?e.payload:void 0,t)];case 1:return(n=o.sent()).authId?(r=t?t.callbackFactory:void 0,[2,new s.default(n,r)]):!n.authId&&n.ok?[2,new c.default(n)]:[2,new u.default(n)]}}))}))},e}();t.default=l},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(19)),i=n(3),a=function(){function e(e){this.payload=e,this.type=i.StepType.LoginFailure}return e.prototype.getCode=function(){return Number(this.payload.code)},e.prototype.getDetail=function(){return this.payload.detail},e.prototype.getMessage=function(){return this.payload.message},e.prototype.getProcessedMessage=function(e){return o.default.parseErrors(this.payload,e)},e.prototype.getReason=function(){return this.payload.reason},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyKey=void 0;var i=n(20);Object.defineProperty(t,"PolicyKey",{enumerable:!0,get:function(){return i.PolicyKey}});var a=o(n(21)),u=function(){function e(){}return e.parseErrors=function(e,t){var n=this,r=[];return e.detail&&e.detail.failedPolicyRequirements&&e.detail.failedPolicyRequirements.map((function(e){r.push.apply(r,[{detail:e,messages:n.parseFailedPolicyRequirement(e,t)}])})),r},e.parseFailedPolicyRequirement=function(e,t){var n=this,r=[];return e.policyRequirements.map((function(o){r.push(n.parsePolicyRequirement(e.property,o,t))})),r},e.parsePolicyRequirement=function(e,t,n){void 0===n&&(n={});var o="string"==typeof t?JSON.parse(t):r({},t),u=o.policyRequirement;return(n[u]||a.default[u]||a.default[i.PolicyKey.UnknownPolicy])(e,o.params?r(r({},o.params),{policyRequirement:u}):{policyRequirement:u})},e}();t.default=u},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyKey=void 0,function(e){e.CannotContainCharacters="CANNOT_CONTAIN_CHARACTERS",e.CannotContainDuplicates="CANNOT_CONTAIN_DUPLICATES",e.CannotContainOthers="CANNOT_CONTAIN_OTHERS",e.LeastCapitalLetters="AT_LEAST_X_CAPITAL_LETTERS",e.LeastNumbers="AT_LEAST_X_NUMBERS",e.MatchRegexp="MATCH_REGEXP",e.MaximumLength="MAX_LENGTH",e.MaximumNumber="MAXIMUM_NUMBER_VALUE",e.MinimumLength="MIN_LENGTH",e.MinimumNumber="MINIMUM_NUMBER_VALUE",e.Required="REQUIRED",e.Unique="UNIQUE",e.UnknownPolicy="UNKNOWN_POLICY",e.ValidArrayItems="VALID_ARRAY_ITEMS",e.ValidDate="VALID_DATE",e.ValidEmailAddress="VALID_EMAIL_ADDRESS_FORMAT",e.ValidNameFormat="VALID_NAME_FORMAT",e.ValidNumber="VALID_NUMBER",e.ValidPhoneFormat="VALID_PHONE_FORMAT",e.ValidQueryFilter="VALID_QUERY_FILTER",e.ValidType="VALID_TYPE"}(r||(r={})),t.PolicyKey=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0});var o=n(46),i=n(20),a=n(47),u=((r={})[i.PolicyKey.CannotContainCharacters]=function(e,t){return e+' must not contain following characters: "'+a.getProp(t,"forbiddenChars","")+'"'},r[i.PolicyKey.CannotContainDuplicates]=function(e,t){return e+'  must not contain duplicates: "'+a.getProp(t,"duplicateValue","")+'"'},r[i.PolicyKey.CannotContainOthers]=function(e,t){return e+' must not contain: "'+a.getProp(t,"disallowedFields","")+'"'},r[i.PolicyKey.LeastCapitalLetters]=function(e,t){var n=a.getProp(t,"numCaps",0);return e+" must contain at least "+n+" capital "+o.plural(n,"letter")},r[i.PolicyKey.LeastNumbers]=function(e,t){var n=a.getProp(t,"numNums",0);return e+" must contain at least "+n+" numeric "+o.plural(n,"value")},r[i.PolicyKey.MatchRegexp]=function(e){return e+' has failed the "MATCH_REGEXP" policy'},r[i.PolicyKey.MaximumLength]=function(e,t){var n=a.getProp(t,"maxLength",0);return e+" must be at most "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MaximumNumber]=function(e){return e+' has failed the "MAXIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.MinimumLength]=function(e,t){var n=a.getProp(t,"minLength",0);return e+" must be at least "+n+" "+o.plural(n,"character")},r[i.PolicyKey.MinimumNumber]=function(e){return e+' has failed the "MINIMUM_NUMBER_VALUE" policy'},r[i.PolicyKey.Required]=function(e){return e+" is required"},r[i.PolicyKey.Unique]=function(e){return e+" must be unique"},r[i.PolicyKey.UnknownPolicy]=function(e,t){return e+': Unknown policy requirement "'+a.getProp(t,"policyRequirement","Unknown")+'"'},r[i.PolicyKey.ValidArrayItems]=function(e){return e+' has failed the "VALID_ARRAY_ITEMS" policy'},r[i.PolicyKey.ValidDate]=function(e){return e+" has an invalid date"},r[i.PolicyKey.ValidEmailAddress]=function(e){return e+" has an invalid email address"},r[i.PolicyKey.ValidNameFormat]=function(e){return e+" has an invalid name format"},r[i.PolicyKey.ValidNumber]=function(e){return e+" has an invalid number"},r[i.PolicyKey.ValidPhoneFormat]=function(e){return e+" has an invalid phone number"},r[i.PolicyKey.ValidQueryFilter]=function(e){return e+' has failed the "VALID_QUERY_FILTER" policy'},r[i.PolicyKey.ValidType]=function(e){return e+' has failed the "VALID_TYPE" policy'},r);t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function(){function e(e){this.payload=e,this.type=r.StepType.LoginSuccess}return e.prototype.getRealm=function(){return this.payload.realm},e.prototype.getSessionToken=function(){return this.payload.tokenId},e.prototype.getSuccessUrl=function(){return this.payload.successUrl},e}();t.default=o},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getName=function(){return this.getOutputByName("name","")},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.setValue=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getDefaultChoice=function(){return this.getOutputByName("defaultChoice",0)},t.prototype.getChoices=function(){return this.getOutputByName("choices",[])},t.prototype.setChoiceIndex=function(e){var t=this.getChoices().length;if(e<0||e>t-1)throw new Error(e+" is out of bounds");this.setInputValue(e)},t.prototype.setChoiceValue=function(e){var t=this.getChoices().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getDefaultOption=function(){return Number(this.getOutputByName("defaultOption",0))},t.prototype.getMessageType=function(){return Number(this.getOutputByName("messageType",0))},t.prototype.getOptions=function(){return this.getOutputByName("options",[])},t.prototype.getOptionType=function(){return Number(this.getOutputByName("optionType",0))},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setOptionIndex=function(e){if(0!==e&&1!==e)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(e)},t.prototype.setOptionValue=function(e){var t=this.getOptions().indexOf(e);if(-1===t)throw new Error('"'+e+'" is not a valid choice');this.setInputValue(t)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.isMetadataRequired=function(){return this.getOutputByName("metadata",!1)},t.prototype.isLocationRequired=function(){return this.getOutputByName("location",!1)},t.prototype.setProfile=function(e){this.setInputValue(JSON.stringify(e))},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getPredefinedQuestions=function(){return this.getOutputByName("predefinedQuestions",[])},t.prototype.setQuestion=function(e){this.setValue("question",e)},t.prototype.setAnswer=function(e){this.setValue("answer",e)},t.prototype.setValue=function(e,t){if(!this.payload.input)throw new Error("KBA payload is missing input");var n=this.payload.input.find((function(t){return t.name.endsWith(e)}));if(!n)throw new Error('No input has name ending in "'+e+'"');n.value=t},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getData=function(){return this.getOutputByName("data",{})},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setName=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getWaitTime=function(){return Number(this.getOutputByName("waitTime",0))},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getSiteKey=function(){return this.getOutputByName("recaptchaSiteKey","")},t.prototype.setResult=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getTerms=function(){return this.getOutputByName("terms","")},t.prototype.getVersion=function(){return this.getOutputByName("version","")},t.prototype.getCreateDate=function(){var e=this.getOutputByName("createDate","");return new Date(e)},t.prototype.setAccepted=function(e){void 0===e&&(e=!0),this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getMessage=function(){return this.getOutputByName("message","")},t.prototype.getMessageType=function(){return this.getOutputByName("messageType","")},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setPassword=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(t){var n=e.call(this,t)||this;return n.payload=t,n}return o(t,e),t.prototype.getPrompt=function(){return this.getOutputByName("prompt","")},t.prototype.getFailedPolicies=function(){return this.getOutputByName("failedPolicies",[])},t.prototype.getPolicies=function(){return this.getOutputByName("policies",[])},t.prototype.isRequired=function(){return this.getOutputByName("required",!1)},t.prototype.setName=function(e){this.setInputValue(e)},t}(i(n(0)).default);t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isOkOr4xx=void 0,t.isOkOr4xx=function(e){return e.ok||4===Math.floor(e.status/100)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){void 0===e&&(e=15);var t=-1,n=0;if(e<4||e>15)throw new Error("Invalid nonce length");return function(){var r=Math.pow(10,2)*+new Date;r===t?n++:(n=0,t=r);var o=(r+n).toString();return+o.substr(o.length-e)}}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(7)),i=function(){function e(){}return e.getCurrentUser=function(){return o.default.getUserInfo()},e}();t.default=i},function(e,t,n){"use strict";function r(e){var t=/new Int8Array\((.+)\)/.exec(e);return null===t||t.length<2?[]:JSON.parse(t[1])}Object.defineProperty(t,"__esModule",{value:!0}),t.parseRelyingPartyId=t.parsePubKeyArray=t.parseAllowCredentialsArray=t.parseNumberArray=t.parseCredentials=t.getIndexOne=t.getClientDataJson=t.ensureArray=void 0,t.ensureArray=function(e){return e||[]},t.getClientDataJson=function(e){var t=new Uint8Array(e.response.clientDataJSON);return(new TextDecoder).decode(t)},t.getIndexOne=function(e){return e?e[1]:""},t.parseCredentials=function(e){try{return e.split("}").filter((function(e){return!!e&&"]"!==e})).map((function(e){var t=r(e);return{id:new Int8Array(t).buffer,type:"public-key"}}))}catch(e){throw new Error("Failed to parse credentials")}},t.parseNumberArray=r,t.parsePubKeyArray=function(e){if(e){if(Array.isArray(e))return e;if("string"==typeof e)return e&&"["===e[0]?JSON.parse(e):(e=e.replace(/(\w+):/g,'"$1":'),JSON.parse("["+e+"]"))}},t.parseAllowCredentialsArray=function(e){if(e){if(Array.isArray(e))return e;if("string"==typeof e)return e&&"["===e[0]?JSON.parse(e):(e=e.replace(/(\w+):/g,'"$1":'),JSON.parse("["+e+"]"))}},t.parseRelyingPartyId=function(e){return e.includes("rpId")?e.replace(/rpId: "(.+)",/,"$1"):e.replace(/id: "(.+)",/,"$1")}},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnStepType=t.WebAuthnOutcome=t.ValidatedCreateUsernameCallback=t.ValidatedCreatePasswordCallback=t.UserManager=t.TokenStorage=t.TokenManager=t.TextOutputCallback=t.TermsAndConditionsCallback=t.StepType=t.SessionManager=t.ResponseType=t.ReCaptchaCallback=t.PollingWaitCallback=t.PolicyKey=t.PKCE=t.PasswordCallback=t.OAuth2Client=t.NameCallback=t.MetadataCallback=t.LocalStorage=t.KbaCreateCallback=t.HttpClient=t.HiddenValueCallback=t.FRWebAuthn=t.FRUser=t.FRStep=t.FRPolicy=t.FRLoginSuccess=t.FRLoginFailure=t.FRDevice=t.FRCallback=t.FRAuth=t.ErrorCode=t.Dispatcher=t.DeviceProfileCallback=t.Deferred=t.ConfirmationCallback=t.Config=t.ChoiceCallback=t.CallbackType=t.Auth=t.AttributeInputCallback=t.nonce=t.defaultMessageCreator=void 0;var u=a(n(14));t.Auth=u.default;var c=n(9);Object.defineProperty(t,"CallbackType",{enumerable:!0,get:function(){return c.CallbackType}}),Object.defineProperty(t,"ErrorCode",{enumerable:!0,get:function(){return c.ErrorCode}});var s=a(n(1));t.Config=s.default;var l=a(n(16));t.Dispatcher=l.default;var f=a(n(17));t.FRAuth=f.default;var d=a(n(0));t.FRCallback=d.default;var p=a(n(23));t.AttributeInputCallback=p.default;var h=a(n(24));t.ChoiceCallback=h.default;var y=a(n(25));t.ConfirmationCallback=y.default;var v=a(n(26));t.DeviceProfileCallback=v.default;var b=a(n(27));t.HiddenValueCallback=b.default;var g=a(n(28));t.KbaCreateCallback=g.default;var _=a(n(29));t.MetadataCallback=_.default;var m=a(n(30));t.NameCallback=m.default;var w=a(n(31));t.PasswordCallback=w.default;var O=a(n(32));t.PollingWaitCallback=O.default;var C=a(n(33));t.ReCaptchaCallback=C.default;var P=a(n(34));t.TermsAndConditionsCallback=P.default;var T=a(n(35));t.TextOutputCallback=T.default;var A=a(n(36));t.ValidatedCreatePasswordCallback=A.default;var k=a(n(37));t.ValidatedCreateUsernameCallback=k.default;var S=n(3);Object.defineProperty(t,"StepType",{enumerable:!0,get:function(){return S.StepType}});var E=a(n(18));t.FRLoginFailure=E.default;var x=a(n(22));t.FRLoginSuccess=x.default;var M=a(n(10));t.FRStep=M.default;var I=a(n(49));t.FRDevice=I.default;var N=i(n(19));t.FRPolicy=N.default,Object.defineProperty(t,"PolicyKey",{enumerable:!0,get:function(){return N.PolicyKey}});var j=a(n(21));t.defaultMessageCreator=j.default;var R=a(n(52));t.FRUser=R.default;var U=i(n(57));t.FRWebAuthn=U.default,Object.defineProperty(t,"WebAuthnOutcome",{enumerable:!0,get:function(){return U.WebAuthnOutcome}}),Object.defineProperty(t,"WebAuthnStepType",{enumerable:!0,get:function(){return U.WebAuthnStepType}});var D=a(n(60));t.HttpClient=D.default;var V=i(n(7));t.OAuth2Client=V.default,Object.defineProperty(t,"ResponseType",{enumerable:!0,get:function(){return V.ResponseType}});var B=a(n(62));t.SessionManager=B.default;var L=a(n(13));t.TokenManager=L.default;var K=a(n(8));t.TokenStorage=K.default;var F=a(n(40));t.UserManager=F.default;var W=a(n(63));t.Deferred=W.default;var z=a(n(39));t.nonce=z.default;var q=a(n(12));t.PKCE=q.default;var H=a(n(64));t.LocalStorage=H.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_TIMEOUT=void 0;t.DEFAULT_TIMEOUT=6e4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRealmUrlPath=void 0,t.getRealmUrlPath=function(e){var t=(e||"").split("/").map((function(e){return e.trim()})).filter((function(e){return""!==e}));return"root"!==t[0]&&t.unshift("root"),t.map((function(e){return"realms/"+e})).join("/")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.clear=t.add=void 0,t.add=function(e,t,n){e[t]=e[t]||[],e[t].indexOf(n)<0&&e[t].push(n)},t.remove=function(e,t,n){if(e[t]){var r=e[t].indexOf(n);r>=0&&e[t].splice(r,1)}},t.clear=function(e,t){Object.keys(e).forEach((function(n){t&&n!==t||delete e[n]}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plural=void 0,t.plural=function(e,t,n){return 1===e?t:void 0!==n?n:t+"s"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProp=void 0,t.getProp=function(e,t,n){return e&&void 0!==e[t]?e[t]:n}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(0)),i=n(9),a=r(n(23)),u=r(n(24)),c=r(n(25)),s=r(n(26)),l=r(n(27)),f=r(n(28)),d=r(n(29)),p=r(n(30)),h=r(n(31)),y=r(n(32)),v=r(n(33)),b=r(n(34)),g=r(n(35)),_=r(n(36)),m=r(n(37));t.default=function(e){switch(e.type){case i.CallbackType.BooleanAttributeInputCallback:return new a.default(e);case i.CallbackType.ChoiceCallback:return new u.default(e);case i.CallbackType.ConfirmationCallback:return new c.default(e);case i.CallbackType.DeviceProfileCallback:return new s.default(e);case i.CallbackType.HiddenValueCallback:return new l.default(e);case i.CallbackType.KbaCreateCallback:return new f.default(e);case i.CallbackType.MetadataCallback:return new d.default(e);case i.CallbackType.NameCallback:return new p.default(e);case i.CallbackType.PasswordCallback:return new h.default(e);case i.CallbackType.PollingWaitCallback:return new y.default(e);case i.CallbackType.ReCaptchaCallback:return new v.default(e);case i.CallbackType.StringAttributeInputCallback:return new a.default(e);case i.CallbackType.TermsAndConditionsCallback:return new b.default(e);case i.CallbackType.TextOutputCallback:return new g.default(e);case i.CallbackType.ValidatedCreatePasswordCallback:return new _.default(e);case i.CallbackType.ValidatedCreateUsernameCallback:return new m.default(e);default:return new o.default(e)}}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(50),l=function(e){function t(t){var n=e.call(this)||this;return n.config={fontNames:s.fontNames,devicePlatforms:s.devicePlatforms,displayProps:s.displayProps,browserProps:s.browserProps,hardwareProps:s.hardwareProps,platformProps:s.platformProps},t&&Object.keys(t).forEach((function(e){if(!s.configurableCategories.includes(e))throw new Error("Device profile configuration category does not exist.");n.config[e]=t[e]})),n}return o(t,e),t.prototype.getBrowserMeta=function(){return navigator?this.reduceToObject(this.config.browserProps,navigator):(console.warn("Cannot collect browser metadata. navigator is not defined."),{})},t.prototype.getBrowserPluginsNames=function(){return navigator&&navigator.plugins?this.reduceToString(Object.keys(navigator.plugins),navigator.plugins):(console.warn("Cannot collect browser plugin information. navigator.plugins is not defined."),"")},t.prototype.getDeviceName=function(){if(!navigator)return console.warn("Cannot collect device name. navigator is not defined."),"";var e=navigator.userAgent,t=navigator.platform;switch(!0){case this.config.devicePlatforms.mac.includes(t):return"Mac (Browser)";case this.config.devicePlatforms.ios.includes(t):return t+" (Browser)";case this.config.devicePlatforms.windows.includes(t):return"Windows (Browser)";case/Android/.test(t)||/Android/.test(e):return"Android (Browser)";case/CrOS/.test(e)||/Chromebook/.test(e):return"Chrome OS (Browser)";case/Linux/.test(t):return"Linux (Browser)";default:return(t||"Unknown")+" (Browser)"}},t.prototype.getDisplayMeta=function(){return screen||console.warn("Cannot collect screen information. screen is not defined."),this.reduceToObject(this.config.displayProps,screen)},t.prototype.getHardwareMeta=function(){return navigator?this.reduceToObject(this.config.hardwareProps,navigator):(console.warn("Cannot collect OS metadata. Navigator is not defined."),{})},t.prototype.getIdentifier=function(){if(!window.crypto||!window.crypto.getRandomValues)return console.warn("Cannot generate profile ID. Crypto and/or getRandomValues is not supported."),"";if(!localStorage)return console.warn("Cannot store profile ID. localStorage is not supported."),"";var e=localStorage.getItem("profile-id");return e||(e=window.crypto.getRandomValues(new Uint32Array(3)).join("-"),localStorage.setItem("profile-id",e)),e},t.prototype.getInstalledFonts=function(){var e=document.createElement("canvas");if(!e)return console.warn("Cannot collect font data. Browser does not support canvas element"),"";var t=e.getContext&&e.getContext("2d");if(!t)return console.warn("Cannot collect font data. Browser does not support 2d canvas context"),"";var n="abcdefghi0123456789";t.font="72px Comic Sans";var r=t.measureText(n).width;return this.config.fontNames.reduce((function(e,o){return t.font="72px "+o+", Comic Sans",t.measureText(n).width!==r&&(e=""+e+o+";"),e}),"")},t.prototype.getLocationCoordinates=function(){return a(this,void 0,void 0,(function(){var e=this;return u(this,(function(t){return navigator&&navigator.geolocation?[2,new Promise((function(t){return a(e,void 0,void 0,(function(){return u(this,(function(e){return navigator.geolocation.getCurrentPosition((function(e){return t({latitude:e.coords.latitude,longitude:e.coords.longitude})}),(function(e){console.warn("Cannot collect geolocation information. "+e.code+": "+e.message),t({})}),{enableHighAccuracy:!0,timeout:s.delay,maximumAge:0}),[2]}))}))}))]:(console.warn("Cannot collect geolocation information. navigator.geolocation is not defined."),[2,Promise.resolve({})])}))}))},t.prototype.getOSMeta=function(){return navigator?this.reduceToObject(this.config.platformProps,navigator):(console.warn("Cannot collect OS metadata. navigator is not defined."),{})},t.prototype.getProfile=function(e){var t=e.location,n=e.metadata;return a(this,void 0,void 0,(function(){var e,r;return u(this,(function(o){switch(o.label){case 0:return e={identifier:this.getIdentifier()},n&&(e.metadata={hardware:i(i({},this.getHardwareMeta()),{display:this.getDisplayMeta()}),browser:i(i({},this.getBrowserMeta()),{plugins:this.getBrowserPluginsNames()}),platform:i(i({},this.getOSMeta()),{deviceName:this.getDeviceName(),fonts:this.getInstalledFonts(),timezone:this.getTimezoneOffset()})}),t?(r=e,[4,this.getLocationCoordinates()]):[3,2];case 1:r.location=o.sent(),o.label=2;case 2:return[2,e]}}))}))},t.prototype.getTimezoneOffset=function(){try{return(new Date).getTimezoneOffset()}catch(e){return console.warn("Cannot collect timezone information. getTimezoneOffset is not defined."),null}},t}(c(n(51)).default);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.platformProps=t.hardwareProps=t.fontNames=t.displayProps=t.devicePlatforms=t.delay=t.configurableCategories=t.browserProps=void 0;t.browserProps=["userAgent","appName","appCodeName","appVersion","appMinorVersion","buildID","product","productSub","vendor","vendorSub","browserLanguage"];t.configurableCategories=["fontNames","displayProps","browserProps","hardwareProps","platformProps"];t.delay=3e4;t.devicePlatforms={mac:["Macintosh","MacIntel","MacPPC","Mac68K"],windows:["Win32","Win64","Windows","WinCE"],ios:["iPhone","iPad","iPod"]};t.displayProps=["width","height","pixelDepth","orientation.angle"];t.fontNames=["cursive","monospace","serif","sans-serif","fantasy","Arial","Arial Black","Arial Narrow","Arial Rounded MT Bold","Bookman Old Style","Bradley Hand ITC","Century","Century Gothic","Comic Sans MS","Courier","Courier New","Georgia","Gentium","Impact","King","Lucida Console","Lalit","Modena","Monotype Corsiva","Papyrus","Tahoma","TeX","Times","Times New Roman","Trebuchet MS","Verdana","Verona"];t.hardwareProps=["cpuClass","deviceMemory","hardwareConcurrency","maxTouchPoints","oscpu"];t.platformProps=["language","platform","userLanguage","systemLanguage"]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.reduceToObject=function(e,t){return e.reduce((function(e,n){if(n.includes(".")){var r=n.split("."),o=r[0],i=r[1],a=t[o]&&t[o][i];e[i]=null!=a?a:""}else e[n]=null!=t[n]?t[n]:null;return e}),{})},e.prototype.reduceToString=function(e,t){return e.reduce((function(e,n){return e=""+e+t[n].filename+";"}),"")},e}();t.default=r},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(7)),u=i(n(13)),c=i(n(40)),s=function(){function e(){}return e.login=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){throw console.info(e,t),new Error("FRUser.login() not implemented")}))}))},e.loginWithUI=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,e.getSession(t)];case 1:return n.sent(),[4,u.default.getTokens({forceRenew:!0})];case 2:return n.sent(),[4,c.default.getCurrentUser()];case 3:return[2,n.sent()];case 4:throw n.sent(),new Error("Login failed");case 5:return[2]}}))}))},e.logout=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,a.default.endSession(e)];case 1:return t.sent(),[4,a.default.revokeToken(e)];case 2:return t.sent(),[4,u.default.deleteTokens()];case 3:return t.sent(),[3,5];case 4:throw t.sent(),new Error("Logout failed");case 5:return[2]}}))}))},e}();t.default=s},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),a=function(){function e(){}return e.get=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t,n){var r=function(){return n()},o=window.indexedDB.open(i.DB_NAME);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(e))return o.result.close(),t(void 0);var n=o.result.transaction(e,"readonly").objectStore(e).get(i.TOKEN_KEY);n.onsuccess=function(e){if(!e||!e.target)throw new Error("Missing storage event target");o.result.close(),t(e.target.result)},n.onerror=r},o.onupgradeneeded=function(){o.result.close(),t(void 0)},o.onerror=r}))]}))}))},e.set=function(e,t){return r(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new Promise((function(n,r){var o=window.indexedDB.open(i.DB_NAME),a=function(){o.result.close(),n()},u=function(){return r()},c=function(){o.result.createObjectStore(e)},s=function(){if(!o.result.objectStoreNames.contains(e)){var n=o.result.version+1;return o.result.close(),(o=window.indexedDB.open(i.DB_NAME,n)).onupgradeneeded=c,o.onsuccess=s,void(o.onerror=u)}var r=o.result.transaction(e,"readwrite");r.onerror=u;var l=r.objectStore(e).put(t,i.TOKEN_KEY);l.onsuccess=a,l.onerror=u};o.onupgradeneeded=c,o.onsuccess=s,o.onerror=u}))]}))}))},e.remove=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t,n){var r=function(){return n()},o=window.indexedDB.open(i.DB_NAME);o.onsuccess=function(){if(!o.result.objectStoreNames.contains(e))return t();var n=o.result.transaction(e,"readwrite").objectStore(e).delete(i.TOKEN_KEY);n.onsuccess=function(){t()},n.onerror=r},o.onerror=r}))]}))}))},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),a=function(){function e(){}return e.get=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){t=localStorage.getItem(i.DB_NAME+"-"+e);try{return[2,Promise.resolve(JSON.parse(t||""))]}catch(e){return console.warn("Could not parse token from localStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},e.set=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){return n=JSON.stringify(t),localStorage.setItem(i.DB_NAME+"-"+e,n),[2]}))}))},e.remove=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return localStorage.removeItem(i.DB_NAME+"-"+e),[2]}))}))},e}();t.default=a},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),a=function(){function e(){}return e.get=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){t=sessionStorage.getItem(i.DB_NAME+"-"+e);try{return[2,Promise.resolve(JSON.parse(t||""))]}catch(e){return console.warn("Could not parse token from sessionStorage. This could be due to accessing a removed token"),[2,void 0]}return[2]}))}))},e.set=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){return n=JSON.stringify(t),sessionStorage.setItem(i.DB_NAME+"-"+e,n),[2]}))}))},e.remove=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){return sessionStorage.removeItem(i.DB_NAME+"-"+e),[2]}))}))},e}();t.default=a},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.ResponseType=void 0,function(e){e.Code="code",e.Token="token"}(r||(r={})),t.ResponseType=r},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnStepType=t.WebAuthnOutcome=void 0;var a=n(9),u=n(58);Object.defineProperty(t,"WebAuthnOutcome",{enumerable:!0,get:function(){return u.WebAuthnOutcome}}),Object.defineProperty(t,"WebAuthnStepType",{enumerable:!0,get:function(){return u.WebAuthnStepType}});var c=n(41),s=n(59),l=function(){function e(){}return e.getWebAuthnStepType=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e),r=this.getTextOutputCallback(e);return t&&n?n.getOutputValue("data").allowCredentials?u.WebAuthnStepType.Authentication:u.WebAuthnStepType.Registration:t&&r?r.getMessage().includes("allowCredentials")?u.WebAuthnStepType.Authentication:u.WebAuthnStepType.Registration:u.WebAuthnStepType.None},e.authenticate=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,a,u,c,l,f;return i(this,(function(i){switch(i.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,o=t.textOutputCallback,!n||!r&&!o)return[3,5];a=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),u=void 0,r?(c=r.getOutputValue("data"),u=this.createAuthenticationPublicKey(c)):o&&(u=s.parseWebAuthnAuthenticateText(o.getMessage())),[4,this.getAuthenticationCredential(u)];case 2:return l=i.sent(),a=this.getAuthenticationOutcome(l),[3,4];case 3:return f=i.sent(),a=this.getErrorOutcome(f),[3,4];case 4:return n.setInputValue(a),[2,e];case 5:throw new Error("Invalid webauthn payload")}}))}))},e.register=function(e){return o(this,void 0,void 0,(function(){var t,n,r,o,a,u,c,l,f;return i(this,(function(i){switch(i.label){case 0:if(t=this.getCallbacks(e),n=t.hiddenCallback,r=t.metadataCallback,o=t.textOutputCallback,!n||!r&&!o)return[3,5];a=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),u=void 0,r?(c=r.getOutputValue("data"),u=this.createRegistrationPublicKey(c)):o&&(u=s.parseWebAuthnRegisterText(o.getMessage())),[4,this.getRegistrationCredential(u)];case 2:return l=i.sent(),a=this.getRegistrationOutcome(l),[3,4];case 3:return f=i.sent(),a=this.getErrorOutcome(f),[3,4];case 4:return n.setInputValue(a),[2,e];case 5:throw new Error("Invalid webauthn payload")}}))}))},e.getCallbacks=function(e){var t=this.getOutcomeCallback(e),n=this.getMetadataCallback(e),r=this.getTextOutputCallback(e),o={hiddenCallback:t};return n?o.metadataCallback=n:r&&(o.textOutputCallback=r),o},e.getMetadataCallback=function(e){return e.getCallbacksOfType(a.CallbackType.MetadataCallback).find((function(e){var t=e.getOutputByName("data",void 0);return t&&t.hasOwnProperty("relyingPartyId")}))},e.getOutcomeCallback=function(e){return e.getCallbacksOfType(a.CallbackType.HiddenValueCallback).find((function(e){return"webAuthnOutcome"===e.getOutputByName("id","")}))},e.getTextOutputCallback=function(e){return e.getCallbacksOfType(a.CallbackType.TextOutputCallback).find((function(e){var t=e.getOutputByName("message",void 0);return t&&t.includes("webAuthnOutcome")}))},e.getAuthenticationCredential=function(e){return o(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return[4,navigator.credentials.get({publicKey:e})];case 1:return[2,t.sent()]}}))}))},e.getAuthenticationOutcome=function(e){if(!window.PublicKeyCredential)return u.WebAuthnOutcome.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=c.getClientDataJson(e),n=e.response;return t+"::"+new Int8Array(n.authenticatorData).toString()+"::"+new Int8Array(n.signature).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.getRegistrationCredential=function(e){return o(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,navigator.credentials.create({publicKey:e})];case 1:return t=r.sent(),[3,3];case 2:throw n=r.sent(),new Error(n.message);case 3:return[2,t]}}))}))},e.getRegistrationOutcome=function(e){if(!window.PublicKeyCredential)return u.WebAuthnOutcome.Unsupported;try{if(null===e)throw new Error("No credential provided");var t=c.getClientDataJson(e),n=e.response;return t+"::"+new Int8Array(n.attestationObject).toString()+"::"+e.id}catch(e){return this.getErrorOutcome(e)}},e.createAuthenticationPublicKey=function(e){var t=e.allowCredentials,n=e.challenge,o=e.relyingPartyId,i=e.timeout,a=c.parseRelyingPartyId(o);return r({allowCredentials:c.parseCredentials(t),challenge:Uint8Array.from(atob(n),(function(e){return e.charCodeAt(0)})).buffer,timeout:i},a&&{rpId:a})},e.createRegistrationPublicKey=function(e){var t=e.pubKeyCredParams,n=c.parsePubKeyArray(t);if(!n)throw new Error("Missing pubKeyCredParams");var o=e.attestationPreference,i=e.authenticatorSelection,a=e.challenge,u=e.relyingPartyId,s=e.relyingPartyName,l=e.timeout,f=e.userId,d=e.userName,p=c.parseRelyingPartyId(u),h=r({name:s},p&&{id:p});return{attestation:o,authenticatorSelection:JSON.parse(i),challenge:Uint8Array.from(atob(a),(function(e){return e.charCodeAt(0)})).buffer,pubKeyCredParams:n,rp:h,timeout:l,user:{displayName:d,id:Int8Array.from(f.split("").map((function(e){return e.charCodeAt(0)}))),name:d}}},e.getErrorOutcome=function(e){var t=e.name?e.name+":":"";return u.WebAuthnOutcome.Error+"::"+t+e.message},e}();t.default=l},function(e,t,n){"use strict";var r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.WebAuthnStepType=t.WebAuthnOutcome=void 0,function(e){e.Error="ERROR",e.Unsupported="unsupported"}(r||(r={})),t.WebAuthnOutcome=r,function(e){e[e.None=0]="None",e[e.Authentication=1]="Authentication",e[e.Registration=2]="Registration"}(o||(o={})),t.WebAuthnStepType=o},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.parseWebAuthnRegisterText=t.parseWebAuthnAuthenticateText=void 0;var o=n(41);t.parseWebAuthnRegisterText=function(e){var t=new TextEncoder,n=o.getIndexOne(e.match(/attestation:\s{0,}"(\w+)"/)),r=Number(o.getIndexOne(e.match(/timeout:\s{0,}(\d+)/))),i=o.getIndexOne(e.match(/"userVerification":\s{0,}"(\w+)"/)),a=o.getIndexOne(e.match(/rp:\s{0,}{([^}]+)}/)).trim(),u=o.getIndexOne(a.match(/id:\s{0,}"([^"]*)"/)),c=o.getIndexOne(a.match(/name:\s{0,}"([^"]*)"/)),s=o.getIndexOne(e.match(/user:\s{0,}{([^]{0,})},/)).trim(),l=o.getIndexOne(s.match(/id:\s{0,}Uint8Array.from\("([^"]+)"/)),f=o.getIndexOne(s.match(/name:\s{0,}"([\d\w._-]+)"/)),d=o.getIndexOne(s.match(/displayName:\s{0,}"([\d\w._-]+)"/)),p=o.getIndexOne(e.match(/pubKeyCredParams:\s{0,}\[([^]+) ]/)).trim(),h=o.parsePubKeyArray(p);if(!h)throw new Error("Missing pubKeyCredParams");var y=o.ensureArray(e.match(/challenge:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),v=JSON.parse(y[2]);return{attestation:n,authenticatorSelection:{userVerification:i},challenge:new Int8Array(v).buffer,excludeCredentials:[],pubKeyCredParams:h,rp:{id:u,name:c},timeout:r,user:{displayName:d,id:t.encode(l),name:f}}},t.parseWebAuthnAuthenticateText=function(e){var t=o.getIndexOne(e.match(/allowCredentials:\s{0,}\[([^]+)\s{0,}]/)).trim(),n=(t.split("},")||[t]).map((function(t){var n=o.getIndexOne(t.match(/"type":\s{0,}"([\w-]+)"/)),r=o.ensureArray(e.match(/"id":\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),i=JSON.parse(r[2]);return{type:n,id:new Int8Array(i).buffer}})),i=Number(o.getIndexOne(e.match(/timeout:\s{0,}(\d+)/))),a=o.ensureArray(e.match(/challenge:\s{0,}new\s{0,}(Uint|Int)8Array\(([^\)]+)/)),u=JSON.parse(a[2]),c=new Int8Array(u).buffer,s=o.getIndexOne(e.match(/rpId:\s{0,}\[([^]+)\s{0,}]/));return r({allowCredentials:n,challenge:c,timeout:i},s&&{id:s})}},function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(1)),s=n(4),l=u(n(16)),f=u(n(17)),d=n(3),p=u(n(10)),h=u(n(13)),y=u(n(8)),v=n(5),b=n(61),g=u(n(6)),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.request=function(e){return i(this,void 0,void 0,(function(){var t,n,r,o,i,u,l,f,d,p,h,v,_,m,w,O;return a(this,(function(a){switch(a.label){case 0:return[4,this._request(e,!1)];case 1:return t=a.sent(),r=!1,b.newTokenRequired(t,e.requiresNewToken)?[4,this._request(e,!0)]:[3,3];case 2:t=a.sent(),a.label=3;case 3:return e.authorization&&e.authorization.handleStep?t.redirected&&b.examineForIGAuthz(t)?(r=!0,n=b.normalizeIGJSON(t),[3,7]):[3,4]:[3,18];case 4:return[4,b.examineForRESTAuthz(t)];case 5:return a.sent()?[4,b.normalizeRESTJSON(t)]:[3,7];case 6:n=a.sent(),a.label=7;case 7:return n&&n.advices?(o=c.default.get(e.authorization.config),i=o.realmPath,u=o.serverConfig,l=b.buildAuthzOptions(n,u.baseUrl,e.timeout,i,u.paths),f=new URL(l.url),d=f.searchParams.get("authIndexType"),p=f.searchParams.get("authIndexValue"),h=g.default({url:new URL(l.url),init:l.init},s.ActionTypes.StartAuthenticate,{type:d,tree:p}),v=h.url,_=h.init,l.url=v.toString(),l.init=_,[4,this._request(l,!1)]):[3,18];case 8:return m=a.sent(),[4,b.isAuthzStep(m)];case 9:if(!a.sent())throw new Error('Error: Initial response from auth server not a "step".');if(!b.hasAuthzAdvice(n))throw new Error("Error: Transactional or Service Advice is empty.");a.label=10;case 10:return a.trys.push([10,17,,18]),[4,this.stepIterator(m,e.authorization.handleStep,d,p)];case 11:a.sent(),w=void 0,a.label=12;case 12:return a.trys.push([12,14,,15]),[4,y.default.get()];case 13:return w=a.sent(),[3,15];case 14:return a.sent(),[3,15];case 15:return r?e.url=b.addAuthzInfoToURL(e.url,n.advices,w):e.init.headers=b.addAuthzInfoToHeaders(e.init,n.advices,w),[4,this._request(e,!1)];case 16:return t=a.sent(),[3,18];case 17:throw O=a.sent(),new Error(O);case 18:return[2,t]}}))}))},t.setAuthHeaders=function(e,t){return i(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,y.default.get()];case 1:return n=r.sent(),[3,3];case 2:return r.sent(),[3,3];case 3:return n&&n.accessToken?[4,h.default.getTokens({forceRenew:t})]:[3,5];case 4:n=r.sent(),e.set("Authorization","Bearer "+n.accessToken),r.label=5;case 5:return[2,e]}}))}))},t.stepIterator=function(e,t,n,r){return i(this,void 0,void 0,(function(){var o,u,c=this;return a(this,(function(s){switch(s.label){case 0:return[4,e.json()];case 1:return o=s.sent(),u=new p.default(o),[2,new Promise((function(e,o){return i(c,void 0,void 0,(function(){return a(this,(function(c){return function u(c){return i(this,void 0,void 0,(function(){var i,s;return a(this,(function(a){switch(a.label){case 0:return[4,t(c)];case 1:return i=a.sent(),[4,f.default.next(i,{type:n,tree:r})];case 2:return(s=a.sent()).type===d.StepType.LoginSuccess?e():s.type===d.StepType.LoginFailure?o("Authentication tree failure."):u(s),[2]}}))}))}(u),[2]}))}))}))]}}))}))},t._request=function(e,t){return i(this,void 0,void 0,(function(){var n,r,o,i,u;return a(this,(function(a){switch(a.label){case 0:return n=e.url,r=e.init,o=e.timeout,i=new Headers(r.headers||{}),e.bypassAuthentication?[3,2]:[4,this.setAuthHeaders(i,t)];case 1:i=a.sent(),a.label=2;case 2:r.headers=i,a.label=3;case 3:return a.trys.push([3,5,,7]),[4,v.withTimeout(fetch(n,r),o)];case 4:return u=a.sent(),[3,7];case 5:return a.sent(),[4,v.withTimeout(fetch(n,{method:"GET"}),o)];case 6:return u=a.sent(),[3,7];case 7:return[2,u]}}))}))},t}(l.default);t.default=_},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeRESTJSON=t.normalizeIGJSON=t.newTokenRequired=t.isAuthzStep=t.hasAuthzAdvice=t.examineForRESTAuthz=t.examineForIGAuthz=t.buildAuthzOptions=t.addAuthzInfoToURL=t.addAuthzInfoToHeaders=void 0;var i=n(2);function a(e){var t=new URL(e).searchParams.get("authIndexValue")||"",n=new DOMParser,r=decodeURIComponent(t),o=n.parseFromString(r,"application/xml").querySelector("Value");return o?o.innerHTML:""}t.addAuthzInfoToHeaders=function(e,t,n){var r=new Headers(e.headers);return t.AuthenticateToServiceConditionAdvice?r.set("x-tree",t.AuthenticateToServiceConditionAdvice[0]):t.TransactionConditionAdvice&&r.set("x-txid",t.TransactionConditionAdvice[0]),n&&n.idToken&&r.set("x-idtoken",n.idToken),r},t.addAuthzInfoToURL=function(e,t,n){var r=new URL(e);if(t.TransactionConditionAdvice){var o=t.TransactionConditionAdvice[0];r.searchParams.append("_txid",o)}return n&&n.idToken&&r.searchParams.append("_idtoken",n.idToken),r.toString()},t.buildAuthzOptions=function(e,t,n,r,o){var a=e.advices&&e.advices.AuthenticateToServiceConditionAdvice,u=e.advices&&e.advices.TransactionConditionAdvice,c="",s="";a?(c=a.reduce((function(e,t){return e=""+t+(e?" "+e:e)}),""),s="AuthenticateToServiceConditionAdvice"):u&&(c=u.reduce((function(e,t){return e=""+t+(e?" "+e:e)}),""),s="TransactionConditionAdvice");var l="<Advices><AttributeValuePair>"+('<Attribute name="'+s+'"/>')+("<Value>"+c+"</Value>")+"</AttributeValuePair></Advices>",f=i.getEndpointPath("authenticate",r,o),d={authIndexType:"composite_advice",authIndexValue:l};return{init:{method:"POST",credentials:"include",headers:{"Accept-API-Version":"resource=2.0, protocol=1.0"}},timeout:n,url:i.resolve(t,f+"?"+i.stringify(d))}},t.examineForIGAuthz=function(e){return(e.headers.get("Content-Type")||"").includes("html")&&e.url.includes("composite_advice")},t.examineForRESTAuthz=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().advices]}}))}))},t.hasAuthzAdvice=function(e){return e.advices&&e.advices.AuthenticateToServiceConditionAdvice?Array.isArray(e.advices.AuthenticateToServiceConditionAdvice)&&e.advices.AuthenticateToServiceConditionAdvice.length>0:!(!e.advices||!e.advices.TransactionConditionAdvice)&&(Array.isArray(e.advices.TransactionConditionAdvice)&&e.advices.TransactionConditionAdvice.length>0)},t.isAuthzStep=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,e.clone().json()];case 1:return[2,!!t.sent().callbacks]}}))}))},t.newTokenRequired=function(e,t){return"function"==typeof t?t(e):401===e.status},t.normalizeIGJSON=function(e){var t={};return e.url.includes("AuthenticateToServiceConditionAdvice")?t.AuthenticateToServiceConditionAdvice=[a(e.url)]:t.TransactionConditionAdvice=[a(e.url)],{resource:"",actions:{},attributes:{},advices:t,ttl:0}},t.normalizeRESTJSON=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return[4,e.json()];case 1:return[2,t.sent()]}}))}))}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function u(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(1)),u=n(15),c=n(38),s=n(5),l=n(4),f=i(n(6)),d=n(2),p=function(){function e(){}return e.logout=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,p,h,y,v;return o(this,(function(o){switch(o.label){case 0:return t=a.default.get(e),n=t.realmPath,r=t.serverConfig,i={credentials:"include",headers:{"accept-api-version":"protocol=1.0,resource=2.0","x-requested-with":u.REQUESTED_WITH},method:"POST"},p=d.getEndpointPath("sessions",n,r.paths)+"?_action=logout",h=d.resolve(r.baseUrl,p),y=f.default({url:new URL(h),init:i},l.ActionTypes.Logout),[4,s.withTimeout(fetch(y.url.toString(),y.init),r.timeout)];case 1:if(v=o.sent(),!c.isOkOr4xx(v))throw new Error("Failed to log out; received "+v.status);return[2,v]}}))}))},e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this;this.promise=new Promise((function(t,n){e.reject=n,e.resolve=t}))};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){void 0===e&&(e=!1),this.storage=e?window.localStorage:window.sessionStorage}return e.prototype.get=function(e){var t=this.storage.getItem(e);if(t)return JSON.parse(t)},e.prototype.set=function(e,t){this.storage.setItem(e,JSON.stringify(t))},e.prototype.remove=function(e){this.storage.removeItem(e)},e}();t.default=r}])}));
//# sourceMappingURL=index.js.map